{% extends 'base.html' %}

{% block css-files %}
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/login.css' %}">
    <link rel="stylesheet" href="{% static 'css/btn-fibo.css' %}">
{% endblock %}

{% block content %}

<div class="text-center register">
    
    <main class="form-signin shadow p-3 mb-5 bg-white rounded" id="divMain">
        
        <h1 class="h3 mb-3 fw-normal">Cadastro de Usuário</h1>
        
        <form method="post">
            {% csrf_token %}
            <input type="text" class="form-control" name="username" placeholder="Nome Completo" required autofocus>
            
            <input type="text" class="form-control" name="cpf" placeholder="CPF" required>

            <input type="email" class="form-control" name="email" placeholder="E-mail" required autofocus>
            
            <input type="password" class="form-control" name="password1" placeholder="Senha" id='pass1' required>
            
            <input type="password" class="form-control" name="password2" placeholder="Confirmação de senha" id="pass2" required>
            
            
            <button type="submit" class="btn btn-lg btn-success" id="btn-register">Redefinir</button>
            
        </form>

        {% if has_error %}
                <p class="messages" >{{error_message}}</p>
        {% endif %}

        <div id="error"></div>

        <p id="tagRegister">Já cadastrado? <a href="{% url 'web:login' %}">Login</a></p>
        
    </main>
    
</div>
{% endblock %}

{% block js-files %} 
    <script>

        document.getElementById('pass2').addEventListener('input', () => {
            pass_1 = document.getElementById('pass1').value;
            pass_2 = document.getElementById('pass2').value;
            
            if (pass_1 != pass_2) {
                
                var div = document.getElementById('error');

                $(div).empty();
                
                var erroTag = document.createElement('p');
                erroTag.setAttribute('class', 'messages');
                erroTag.innerText = 'Senhas não são iguais.'
                div.append(erroTag)
                
                document.getElementById('btn-register').disabled = true;


            } else {
                document.getElementById('btn-register').disabled = false;
            }

        } )

    </script>
{% endblock%}
